<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çƒ¹é¥ªUIæµ‹è¯• - ææ–™å›¾æ ‡ç½‘æ ¼æ˜¾ç¤º</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .test-info {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .test-info h1 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .test-info p {
            margin: 5px 0;
            color: #666;
        }
        .feature {
            background: #e8f5e9;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #4caf50;
        }
        .preview {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #2196f3;
        }
        .preview h3 {
            margin: 0 0 10px 0;
            color: #2196f3;
        }
        .preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 12px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
        }
        .preview-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
            background: white;
            border-radius: 8px;
            border: 2px solid #4caf50;
        }
        .preview-icon {
            width: 64px;
            height: 64px;
            background: #f0f0f0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            margin-bottom: 6px;
        }
        .preview-name {
            font-size: 11px;
            text-align: center;
            color: #333;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        button:hover {
            background: #5568d3;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="test-info">
        <h1>ğŸ³ çƒ¹é¥ªUIæµ‹è¯• - ææ–™å›¾æ ‡ç½‘æ ¼æ˜¾ç¤º</h1>
        <p>æµ‹è¯•çƒ¹é¥ªé¢æ¿ä¸­æ‰€éœ€ææ–™çš„ç½‘æ ¼å›¾æ ‡æ˜¾ç¤ºåŠŸèƒ½</p>
        
        <div class="feature">
            <strong>âœ¨ æ–°åŠŸèƒ½ï¼š</strong>
            <ul>
                <li>ææ–™ä»¥ç½‘æ ¼å½¢å¼æ˜¾ç¤ºåœ¨çº¢æ¡†åŒºåŸŸå†…</li>
                <li>æ¯ä¸ªææ–™æ˜¾ç¤ºä¸ºå¡ç‰‡ï¼šå›¾æ ‡ + åç§°</li>
                <li>å›¾æ ‡å°ºå¯¸ï¼š64x64px</li>
                <li>æ•°é‡æ˜¾ç¤ºåœ¨å›¾æ ‡å³ä¸‹è§’ï¼ˆæ‹¥æœ‰/éœ€è¦ï¼‰</li>
                <li>çŠ¶æ€æŒ‡ç¤ºå™¨åœ¨å¡ç‰‡å³ä¸Šè§’ï¼ˆâœ“ æˆ– âœ—ï¼‰</li>
                <li>ææ–™ä¸è¶³æ—¶æ˜¾ç¤ºçº¢è‰²è¾¹æ¡†ï¼Œå……è¶³æ—¶æ˜¾ç¤ºç»¿è‰²è¾¹æ¡†</li>
                <li>é¼ æ ‡æ‚¬åœæ—¶å¡ç‰‡ä¸Šæµ®æ•ˆæœ</li>
                <li>è‡ªé€‚åº”ç½‘æ ¼å¸ƒå±€ï¼Œè‡ªåŠ¨è°ƒæ•´åˆ—æ•°</li>
            </ul>
        </div>

        <div class="preview">
            <h3>ğŸ“‹ å¸ƒå±€é¢„è§ˆ</h3>
            <p>ææ–™å°†ä»¥è¿™ç§ç½‘æ ¼å½¢å¼æ˜¾ç¤ºï¼š</p>
            <div class="preview-grid">
                <div class="preview-item">
                    <div class="preview-icon">ğŸ¬</div>
                    <div class="preview-name">å²è±å§†ç”œç </div>
                </div>
                <div class="preview-item">
                    <div class="preview-icon">ğŸ„</div>
                    <div class="preview-name">è¿·é¦™è‡</div>
                </div>
                <div class="preview-item">
                    <div class="preview-icon">ğŸ</div>
                    <div class="preview-name">å…‰æ»‘è›‡çš®</div>
                </div>
            </div>
        </div>
    </div>

    <div class="controls">
        <h2>æµ‹è¯•æ“ä½œ</h2>
        <button onclick="openCooking()">æ‰“å¼€çƒ¹é¥ªé¢æ¿</button>
        <button onclick="addTestMaterials()">æ·»åŠ æµ‹è¯•ææ–™</button>
        <button onclick="addPartialMaterials()">æ·»åŠ éƒ¨åˆ†ææ–™ï¼ˆæµ‹è¯•ä¸è¶³çŠ¶æ€ï¼‰</button>
        <button onclick="clearInventory()">æ¸…ç©ºèƒŒåŒ…</button>
        <button onclick="showInventory()">æŸ¥çœ‹èƒŒåŒ…</button>
    </div>

    <script type="module">
        import { World } from './dist/ecs/World.js';
        import { ItemSystem } from './dist/game/systems/ItemSystem.js';
        import { CookingSystem } from './dist/game/systems/CookingSystem.js';
        import { UIManager } from './dist/ui/UIManager.js';
        import { EventSystem } from './dist/ecs/EventSystem.js';
        import { CookingPanel } from './dist/ui/components/CookingPanel.js';

        // Initialize systems
        const world = new World();
        const eventSystem = new EventSystem();
        const itemSystem = new ItemSystem(world);
        const cookingSystem = new CookingSystem();
        const uiManager = new UIManager(eventSystem);

        world.addSystem(itemSystem);
        world.addSystem(cookingSystem);
        world.initialize();

        cookingSystem.setItemSystem(itemSystem);

        // Create cooking panel
        const cookingPanel = new CookingPanel(uiManager, eventSystem, world, cookingSystem);
        cookingPanel.setPlayerId(1);

        // Load cooking recipes
        fetch('src/game/data/cooking-recipes.json')
            .then(res => res.json())
            .then(data => {
                cookingSystem.loadRecipes(data);
                console.log('âœ… çƒ¹é¥ªé…æ–¹åŠ è½½å®Œæˆ');
            })
            .catch(err => {
                console.error('âŒ åŠ è½½çƒ¹é¥ªé…æ–¹å¤±è´¥:', err);
            });

        window.openCooking = function() {
            cookingPanel.show();
            cookingPanel.render();
            console.log('ğŸ³ çƒ¹é¥ªé¢æ¿å·²æ‰“å¼€');
        };

        window.addTestMaterials = function() {
            // Add materials for different recipes
            const materials = [
                { id: 'slime_sweet_pearl', qty: 10, name: 'å²è±å§†ç”œç ' },
                { id: 'two_headed_snake_liver', qty: 5, name: 'åŒå¤´è›‡è‚' },
                { id: 'smooth_snake_skin', qty: 10, name: 'å…‰æ»‘è›‡çš®' },
                { id: 'mystic_mushroom', qty: 10, name: 'è¿·é¦™è‡' },
                { id: 'sweet_syrup_gland', qty: 5, name: 'ç”œæµ†è…ºä½“' },
                { id: 'grass_mushroom_worm_thin_wing', qty: 5, name: 'è‰è‡è™«è–„ç¿¼' },
                { id: 'lavender', qty: 10, name: 'å…°é¦™è‰' },
                { id: 'bitter_root', qty: 10, name: 'è‹¦æ ¹' },
                { id: 'salt_stone_crystal', qty: 5, name: 'ç›çŸ³ç»“æ™¶' },
                { id: 'blue_spider_front_leg', qty: 10, name: 'è“è››å‰è…¿' },
                { id: 'bitter_juice', qty: 5, name: 'è‹¦æ±' },
                { id: 'coarse_salt_block', qty: 10, name: 'ç²—ç›å—' },
                { id: 'blue_cheese_ball', qty: 5, name: 'è“å¥¶é…ªçƒ' },
                { id: 'burst_fruit', qty: 10, name: 'çˆ†è£‚æœ' }
            ];

            materials.forEach(mat => {
                itemSystem.addItem(mat.id, mat.qty);
            });

            console.log('âœ… å·²æ·»åŠ æµ‹è¯•ææ–™åˆ°èƒŒåŒ…');
            alert('å·²æ·»åŠ æµ‹è¯•ææ–™ï¼ç°åœ¨å¯ä»¥æ‰“å¼€çƒ¹é¥ªé¢æ¿æŸ¥çœ‹ææ–™å›¾æ ‡ç½‘æ ¼ã€‚');
        };

        window.addPartialMaterials = function() {
            // Add only partial materials to test insufficient state
            itemSystem.addItem('slime_sweet_pearl', 1); // Need 3
            itemSystem.addItem('bitter_root', 2); // Need 3
            
            console.log('âœ… å·²æ·»åŠ éƒ¨åˆ†ææ–™ï¼ˆä¸è¶³çŠ¶æ€ï¼‰');
            alert('å·²æ·»åŠ éƒ¨åˆ†ææ–™ï¼æ‰“å¼€çƒ¹é¥ªé¢æ¿å¯ä»¥çœ‹åˆ°çº¢è‰²è¾¹æ¡†è¡¨ç¤ºææ–™ä¸è¶³ã€‚');
        };

        window.clearInventory = function() {
            itemSystem.clearInventory();
            console.log('ğŸ—‘ï¸ èƒŒåŒ…å·²æ¸…ç©º');
            alert('èƒŒåŒ…å·²æ¸…ç©ºï¼');
        };

        window.showInventory = function() {
            const inventory = itemSystem.getInventory();
            console.log('ğŸ“¦ å½“å‰èƒŒåŒ…:', inventory);
            
            if (inventory.length === 0) {
                alert('èƒŒåŒ…æ˜¯ç©ºçš„ï¼');
            } else {
                const items = inventory.map(slot => {
                    const item = itemSystem.getItem(slot.itemId);
                    return `${item?.name || slot.itemId}: ${slot.quantity}`;
                }).join('\n');
                alert('èƒŒåŒ…ç‰©å“ï¼š\n\n' + items);
            }
        };

        // Auto-add some materials on load
        setTimeout(() => {
            console.log('ğŸ’¡ æç¤ºï¼šç‚¹å‡»"æ·»åŠ æµ‹è¯•ææ–™"æŒ‰é’®æ¥æ·»åŠ çƒ¹é¥ªææ–™');
        }, 1000);
    </script>
</body>
</html>
