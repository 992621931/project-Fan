<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä»£å·ï¼šé¥­ - ä»»åŠ¡æ€»è§ˆ</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      color: #e0e0e0;
      min-height: 100vh;
      padding: 24px;
    }
    h1 {
      text-align: center;
      font-size: 28px;
      color: #ffd700;
      margin-bottom: 8px;
      text-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
    }
    .subtitle {
      text-align: center;
      color: #888;
      font-size: 14px;
      margin-bottom: 32px;
    }
    .stats {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-bottom: 32px;
      flex-wrap: wrap;
    }
    .stat-card {
      background: rgba(255,255,255,0.06);
      border-radius: 12px;
      padding: 16px 28px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.08);
    }
    .stat-card .num { font-size: 28px; font-weight: bold; }
    .stat-card .label { font-size: 12px; color: #999; margin-top: 4px; }
    .stat-main .num { color: #e74c3c; }
    .stat-side .num { color: #3498db; }
    .stat-daily .num { color: #f39c12; }

    .tabs {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }
    .tab-btn {
      padding: 10px 24px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
      background: rgba(255,255,255,0.08);
      color: #ccc;
    }
    .tab-btn:hover { background: rgba(255,255,255,0.15); }
    .tab-btn.active-main { background: #e74c3c; color: white; }
    .tab-btn.active-side { background: #3498db; color: white; }
    .tab-btn.active-daily { background: #f39c12; color: white; }
    .tab-btn.active-all { background: #9b59b6; color: white; }

    .section { margin-bottom: 32px; }
    .section-title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 16px;
      padding-left: 12px;
      border-left: 4px solid;
    }
    .section-main .section-title { border-color: #e74c3c; color: #e74c3c; }
    .section-side .section-title { border-color: #3498db; color: #3498db; }
    .section-daily .section-title { border-color: #f39c12; color: #f39c12; }

    .quest-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 16px;
    }
    .quest-card {
      background: rgba(255,255,255,0.06);
      border-radius: 12px;
      padding: 20px;
      border: 1px solid rgba(255,255,255,0.08);
      transition: transform 0.2s, box-shadow 0.2s;
      position: relative;
    }
    .quest-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    }
    .quest-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .quest-order {
      width: 28px; height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      color: white;
      flex-shrink: 0;
    }
    .order-main { background: #e74c3c; }
    .order-side { background: #3498db; }
    .order-daily { background: #f39c12; }
    .quest-name { font-size: 16px; font-weight: bold; color: #fff; }
    .quest-type-badge {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 4px;
      color: white;
      font-weight: 600;
      margin-left: auto;
      flex-shrink: 0;
    }
    .badge-main { background: #e74c3c; }
    .badge-side { background: #3498db; }
    .badge-daily { background: #f39c12; }

    .quest-desc {
      font-size: 13px;
      color: #aaa;
      line-height: 1.5;
      margin-bottom: 12px;
    }
    .quest-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
    }
    .meta-tag {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 4px;
      background: rgba(255,255,255,0.08);
      color: #bbb;
    }
    .objectives-title {
      font-size: 12px;
      color: #888;
      margin-bottom: 6px;
      font-weight: 600;
    }
    .objective {
      font-size: 13px;
      color: #ccc;
      padding: 6px 10px;
      background: rgba(255,255,255,0.04);
      border-radius: 6px;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .obj-icon { font-size: 14px; }
    .obj-amount {
      margin-left: auto;
      font-size: 11px;
      color: #888;
      background: rgba(255,255,255,0.06);
      padding: 2px 6px;
      border-radius: 4px;
    }
    .rewards {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid rgba(255,255,255,0.08);
    }
    .rewards-title {
      font-size: 12px;
      color: #888;
      margin-bottom: 6px;
      font-weight: 600;
    }
    .reward-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    .reward-tag {
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 6px;
      font-weight: 600;
    }
    .reward-gold { background: rgba(255, 215, 0, 0.15); color: #ffd700; }
    .reward-crystal { background: rgba(138, 43, 226, 0.15); color: #bb86fc; }
    .reward-item { background: rgba(46, 204, 113, 0.15); color: #2ecc71; }
    .reward-unlock { background: rgba(231, 76, 60, 0.15); color: #e74c3c; }

    .prereq {
      margin-top: 8px;
      font-size: 11px;
      color: #777;
    }
    .prereq span { color: #e67e22; }

    .chain-arrow {
      text-align: center;
      color: #555;
      font-size: 20px;
      margin: 4px 0;
    }

    /* Flow chart for main quests */
    .flow-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0;
      margin-bottom: 32px;
    }
    .flow-card {
      width: 100%;
      max-width: 500px;
    }
    .flow-arrow {
      color: #e74c3c;
      font-size: 24px;
      opacity: 0.5;
      padding: 4px 0;
    }

    .hidden { display: none; }

    @media (max-width: 600px) {
      body { padding: 12px; }
      .quest-grid { grid-template-columns: 1fr; }
      h1 { font-size: 22px; }
    }
  </style>
</head>
<body>
  <h1>ğŸ® ä»£å·ï¼šé¥­ - ä»»åŠ¡æ€»è§ˆ</h1>
  <p class="subtitle">å…± 29 ä¸ªä»»åŠ¡ | ä¸»çº¿ 10 Â· æ”¯çº¿ 10 Â· æ—¥å¸¸ 9</p>

  <div class="stats">
    <div class="stat-card stat-main"><div class="num">10</div><div class="label">ä¸»çº¿ä»»åŠ¡</div></div>
    <div class="stat-card stat-side"><div class="num">10</div><div class="label">æ”¯çº¿ä»»åŠ¡</div></div>
    <div class="stat-card stat-daily"><div class="num">9</div><div class="label">æ—¥å¸¸ä»»åŠ¡</div></div>
  </div>

  <div class="tabs">
    <button class="tab-btn active-all" onclick="showTab('all')">å…¨éƒ¨</button>
    <button class="tab-btn" onclick="showTab('main')">ä¸»çº¿ä»»åŠ¡</button>
    <button class="tab-btn" onclick="showTab('side')">æ”¯çº¿ä»»åŠ¡</button>
    <button class="tab-btn" onclick="showTab('daily')">æ—¥å¸¸ä»»åŠ¡</button>
  </div>

  <div id="content"></div>

  <script>
    const NPC_NAMES = {
      'village_chief': 'æ‘é•¿',
      'bartender': 'é…’ä¿',
      'blacksmith_zz': 'é“åŒ ZZ',
      'alchemist_tuanzi': 'ç‚¼é‡‘å¸ˆå›¢å­',
      'chef_curry': 'å¨å¸ˆå’–å–±',
      'trainer_alin': 'è®­ç»ƒå¸ˆé˜¿æ—',
      'summoner_kaoezi': 'å¬å”¤å¸ˆçƒ¤é¥µå­',
      'scholar_xiaomei': 'å­¦è€…å°æ¢…',
      'maid': 'å¥³ä»†è‰¯å­',
      'merchant_youliang': 'å•†äººæ²¹äº®',
      'merchant_xiaoheiyang': 'å•†äººå°é»‘ç¾Š',
      'player_stall': 'ç©å®¶æ‘Šä½'
    };

    const OBJ_ICONS = {
      'scene_visit': 'ğŸ—ºï¸',
      'recruit': 'ğŸ‘¥',
      'combat_complete': 'âš”ï¸',
      'gift_give': 'ğŸ',
      'craft_item': 'ğŸ”¨',
      'affinity_level': 'â¤ï¸',
      'item_possession': 'ğŸ“¦',
      'dialogue': 'ğŸ’¬'
    };

    const TYPE_NAMES = { 'main': 'ä¸»çº¿', 'side': 'æ”¯çº¿', 'daily': 'æ—¥å¸¸' };

    const quests = {
      main: [
        { id:"main_01_meet_chief", name:"åˆæ¥ä¹åˆ°", desc:"å‰å¾€å¹¿åœºæ‹œè®¿æ‘é•¿ï¼Œäº†è§£æ‘åº„çš„åŸºæœ¬æƒ…å†µã€‚", npc:"village_chief", objectives:[{type:"scene_visit",target:"square",amount:1,desc:"å‰å¾€å¹¿åœº"}], rewards:{gold:100}, prereqs:[], order:1 },
        { id:"main_02_visit_tavern", name:"é…’é¦†æ¢è®¿", desc:"å‰å¾€é…’é¦†ä¸é…’ä¿äº¤è°ˆï¼Œäº†è§£å†’é™©è€…æ‹›å‹Ÿçš„ä¿¡æ¯ã€‚", npc:"bartender", objectives:[{type:"scene_visit",target:"tavern",amount:1,desc:"å‰å¾€é…’é¦†"}], rewards:{gold:150}, prereqs:["main_01_meet_chief"], order:2 },
        { id:"main_03_first_recruit", name:"æ‹›å‹Ÿä¼™ä¼´", desc:"åœ¨é…’é¦†æ‹›å‹Ÿä½ çš„ç¬¬ä¸€ä½å†’é™©è€…åŒä¼´ã€‚", npc:"bartender", objectives:[{type:"recruit",target:"any",amount:1,desc:"æ‹›å‹Ÿä¸€åå†’é™©è€…"}], rewards:{gold:300}, prereqs:["main_02_visit_tavern"], order:3 },
        { id:"main_04_explore_grassland", name:"è‰åŸå†ç»ƒ", desc:"å¸¦é¢†é˜Ÿä¼å‰å¾€è‰åŸè¿›è¡Œç¬¬ä¸€æ¬¡æ¢ç´¢ã€‚", npc:"village_chief", objectives:[{type:"combat_complete",target:"grassland",amount:1,desc:"åœ¨è‰åŸå®Œæˆä¸€æ¬¡æˆ˜æ–—"}], rewards:{gold:500,unlockNpc:"blacksmith_zz"}, prereqs:["main_03_first_recruit"], order:4 },
        { id:"main_05_meet_blacksmith", name:"é“åŒ çš„é”¤å£°", desc:"æ‹œè®¿é“åŒ ZZï¼Œäº†è§£è£…å¤‡åˆ¶ä½œçš„å¥¥ç§˜ã€‚", npc:"blacksmith_zz", objectives:[{type:"gift_give",target:"blacksmith_zz",amount:1,desc:"å‘é“åŒ ZZèµ é€ä¸€ä»½ç¤¼ç‰©"}], rewards:{gold:400,unlockNpc:"alchemist_tuanzi"}, prereqs:["main_04_explore_grassland"], order:5 },
        { id:"main_06_meet_alchemist", name:"ç‚¼é‡‘æœ¯å…¥é—¨", desc:"æ‹œè®¿ç‚¼é‡‘å¸ˆå›¢å­ï¼Œå­¦ä¹ è¯å‰‚åˆ¶ä½œçš„åŸºç¡€çŸ¥è¯†ã€‚", npc:"alchemist_tuanzi", objectives:[{type:"gift_give",target:"alchemist_tuanzi",amount:1,desc:"å‘ç‚¼é‡‘å¸ˆå›¢å­èµ é€ä¸€ä»½ç¤¼ç‰©"}], rewards:{gold:400,unlockNpc:"chef_curry"}, prereqs:["main_05_meet_blacksmith"], order:6 },
        { id:"main_07_meet_chef", name:"å¨æˆ¿çš„ç§˜å¯†", desc:"æ‹œè®¿å¨å¸ˆå’–å–±ï¼Œå“å°æ‘åº„çš„ç¾é£Ÿã€‚", npc:"chef_curry", objectives:[{type:"gift_give",target:"chef_curry",amount:1,desc:"å‘å¨å¸ˆå’–å–±èµ é€ä¸€ä»½ç¤¼ç‰©"}], rewards:{gold:400,unlockNpc:"trainer_alin"}, prereqs:["main_06_meet_alchemist"], order:7 },
        { id:"main_08_meet_trainer", name:"è½¬èŒä¹‹è·¯", desc:"æ‹œè®¿è®­ç»ƒå¸ˆé˜¿æ—ï¼Œäº†è§£è§’è‰²è½¬èŒç³»ç»Ÿã€‚", npc:"trainer_alin", objectives:[{type:"gift_give",target:"trainer_alin",amount:1,desc:"å‘è®­ç»ƒå¸ˆé˜¿æ—èµ é€ä¸€ä»½ç¤¼ç‰©"}], rewards:{gold:400,unlockNpc:"summoner_kaoezi"}, prereqs:["main_07_meet_chef"], order:8 },
        { id:"main_09_meet_summoner", name:"å¼‚ç•Œä¹‹é—¨", desc:"æ‹œè®¿å¬å”¤å¸ˆçƒ¤é¥µå­ï¼Œæ¢ç´¢å¼‚ç•Œå¬å”¤çš„åŠ›é‡ã€‚", npc:"summoner_kaoezi", objectives:[{type:"gift_give",target:"summoner_kaoezi",amount:1,desc:"å‘å¬å”¤å¸ˆçƒ¤é¥µå­èµ é€ä¸€ä»½ç¤¼ç‰©"}], rewards:{gold:400,unlockNpc:"scholar_xiaomei"}, prereqs:["main_08_meet_trainer"], order:9 },
        { id:"main_10_meet_scholar", name:"çŸ¥è¯†çš„æ®¿å ‚", desc:"æ‹œè®¿å­¦è€…å°æ¢…ï¼Œå¼€å¯å¡ç‰Œæ”¶é›†ä¹‹æ—…ã€‚", npc:"scholar_xiaomei", objectives:[{type:"gift_give",target:"scholar_xiaomei",amount:1,desc:"å‘å­¦è€…å°æ¢…èµ é€ä¸€ä»½ç¤¼ç‰©"}], rewards:{gold:1000,crystal:50}, prereqs:["main_09_meet_summoner"], order:10 }
      ],
      side: [
        { id:"side_blacksmith_01", name:"é“åŒ çš„è€ƒéªŒ", desc:"ä¸ºé“åŒ åˆ¶ä½œä¸€æŠŠé“œè´¨é•¿å‰‘ï¼Œè¯æ˜ä½ çš„é”»é€ å®åŠ›ã€‚", npc:"blacksmith_zz", objectives:[{type:"craft_item",target:"copper_longsword",amount:1,desc:"åˆ¶ä½œé“œè´¨é•¿å‰‘ x1"}], rewards:{gold:500,items:[{id:"copper_ore",qty:10}]}, prereqs:[], order:1 },
        { id:"side_blacksmith_02", name:"å…¨å‰¯æ­¦è£…", desc:"åˆ¶ä½œä¸€ä»¶é“œç”²æŠ¤èƒ¸å’Œä¸€é¢å°åœ†ç›¾ã€‚", npc:"blacksmith_zz", objectives:[{type:"craft_item",target:"copper_chestplate",amount:1,desc:"åˆ¶ä½œé“œç”²æŠ¤èƒ¸ x1"},{type:"craft_item",target:"small_round_shield",amount:1,desc:"åˆ¶ä½œå°åœ†ç›¾ x1"}], rewards:{gold:800,items:[{id:"iron_ore",qty:5}]}, prereqs:["side_blacksmith_01"], order:2 },
        { id:"side_chef_01", name:"åˆçº§å¨è‰º", desc:"åˆ¶ä½œä¸€ä»½å²è±å§†QQç³–ï¼Œå±•ç¤ºä½ çš„çƒ¹é¥ªå¤©èµ‹ã€‚", npc:"chef_curry", objectives:[{type:"craft_item",target:"slime_qq_candy",amount:1,desc:"åˆ¶ä½œå²è±å§†QQç³– x1"}], rewards:{gold:400,items:[{id:"slime_sweet_pearl",qty:5}]}, prereqs:[], order:1 },
        { id:"side_chef_02", name:"è‰åŸé£å‘³", desc:"åˆ¶ä½œä¸€ä»½è‰åŸå¥—é¤ï¼Œè¿™æ˜¯å¨å¸ˆå’–å–±çš„æ‹›ç‰Œèœã€‚", npc:"chef_curry", objectives:[{type:"craft_item",target:"grassland_set_meal",amount:1,desc:"åˆ¶ä½œè‰åŸå¥—é¤ x1"}], rewards:{gold:1000,crystal:20}, prereqs:["side_chef_01"], order:2 },
        { id:"side_alchemist_01", name:"è¯å‰‚å­¦åŸºç¡€", desc:"åˆ¶ä½œä¸€ç“¶å­¦å¾’çº§æ²»ç–—è¯å‰‚ã€‚", npc:"alchemist_tuanzi", objectives:[{type:"craft_item",target:"apprentice_healing_potion",amount:1,desc:"åˆ¶ä½œå­¦å¾’çº§æ²»ç–—è¯å‰‚ x1"}], rewards:{gold:400,items:[{id:"orchid_herb",qty:5}]}, prereqs:[], order:1 },
        { id:"side_alchemist_02", name:"å…¨èƒ½è¯å‰‚å¸ˆ", desc:"åˆ¶ä½œä¸€ç“¶å­¦å¾’çº§å¤§åŠ›è¯å‰‚å’Œä¸€ç“¶å­¦å¾’çº§æ€¥é€Ÿè¯å‰‚ã€‚", npc:"alchemist_tuanzi", objectives:[{type:"craft_item",target:"apprentice_strength_potion",amount:1,desc:"åˆ¶ä½œå­¦å¾’çº§å¤§åŠ›è¯å‰‚ x1"},{type:"craft_item",target:"apprentice_speed_potion",amount:1,desc:"åˆ¶ä½œå­¦å¾’çº§æ€¥é€Ÿè¯å‰‚ x1"}], rewards:{gold:800,crystal:15}, prereqs:["side_alchemist_01"], order:2 },
        { id:"side_bartender_01", name:"é…’ä¿çš„è¯·æ±‚", desc:"æ‹›å‹Ÿ3åå†’é™©è€…ï¼Œå¸®åŠ©é…’ä¿æ´»è·ƒé…’é¦†çš„æ°”æ°›ã€‚", npc:"bartender", objectives:[{type:"recruit",target:"any",amount:3,desc:"æ‹›å‹Ÿ3åå†’é™©è€…"}], rewards:{gold:600}, prereqs:[], order:1 },
        { id:"side_trainer_01", name:"å®åŠ›çš„è¯æ˜", desc:"åœ¨è‰åŸå®Œæˆ5æ¬¡æˆ˜æ–—ï¼Œå‘è®­ç»ƒå¸ˆè¯æ˜ä½ çš„å®åŠ›ã€‚", npc:"trainer_alin", objectives:[{type:"combat_complete",target:"grassland",amount:5,desc:"åœ¨è‰åŸå®Œæˆ5æ¬¡æˆ˜æ–—"}], rewards:{gold:1000,crystal:30}, prereqs:[], order:1 },
        { id:"side_scholar_01", name:"çŸ¥è¯†æ”¶é›†è€…", desc:"ä¸5ä½ä¸åŒçš„NPCäº¤è°ˆï¼Œæ”¶é›†æ‘åº„çš„æ•…äº‹ã€‚", npc:"scholar_xiaomei", objectives:[{type:"gift_give",target:"any",amount:5,desc:"å‘5ä½NPCèµ é€ç¤¼ç‰©"}], rewards:{gold:800,crystal:25}, prereqs:[], order:1 },
        { id:"side_summoner_01", name:"å¼‚ç•Œæ¢ç´¢è€…", desc:"æ‹›å‹Ÿ5åå†’é™©è€…ï¼Œä¸ºå¼‚ç•Œå¬å”¤ç§¯è“„åŠ›é‡ã€‚", npc:"summoner_kaoezi", objectives:[{type:"recruit",target:"any",amount:5,desc:"æ‹›å‹Ÿ5åå†’é™©è€…"}], rewards:{gold:1000,crystal:30}, prereqs:[], order:1 }
      ],
      daily: [
        { id:"daily_blacksmith_01", name:"æ—¥å¸¸é”»é€ ", desc:"åˆ¶ä½œä»»æ„ä¸€ä»¶è£…å¤‡ã€‚", npc:"blacksmith_zz", objectives:[{type:"craft_item",target:"any_equipment",amount:1,desc:"åˆ¶ä½œä»»æ„è£…å¤‡ x1"}], rewards:{gold:200}, prereqs:[], order:1 },
        { id:"daily_chef_01", name:"æ—¥å¸¸çƒ¹é¥ª", desc:"åˆ¶ä½œä»»æ„ä¸€é“æ–™ç†ã€‚", npc:"chef_curry", objectives:[{type:"craft_item",target:"any_cooking",amount:1,desc:"åˆ¶ä½œä»»æ„æ–™ç† x1"}], rewards:{gold:200}, prereqs:[], order:1 },
        { id:"daily_alchemist_01", name:"æ—¥å¸¸ç‚¼é‡‘", desc:"åˆ¶ä½œä»»æ„ä¸€ç“¶è¯å‰‚ã€‚", npc:"alchemist_tuanzi", objectives:[{type:"craft_item",target:"any_alchemy",amount:1,desc:"åˆ¶ä½œä»»æ„è¯å‰‚ x1"}], rewards:{gold:200}, prereqs:[], order:1 },
        { id:"daily_bartender_01", name:"æ—¥å¸¸æ‹›å‹Ÿ", desc:"æ‹›å‹Ÿä¸€åæ–°çš„å†’é™©è€…ã€‚", npc:"bartender", objectives:[{type:"recruit",target:"any",amount:1,desc:"æ‹›å‹Ÿ1åå†’é™©è€…"}], rewards:{gold:150}, prereqs:[], order:1 },
        { id:"daily_trainer_01", name:"æ—¥å¸¸è®­ç»ƒ", desc:"å®Œæˆä¸€æ¬¡æˆ˜æ–—è®­ç»ƒã€‚", npc:"trainer_alin", objectives:[{type:"combat_complete",target:"any",amount:1,desc:"å®Œæˆ1æ¬¡æˆ˜æ–—"}], rewards:{gold:150}, prereqs:[], order:1 },
        { id:"daily_village_chief_01", name:"æ‘é•¿çš„å˜±æ‰˜", desc:"å’Œæ‘é•¿è¿›è¡Œä¸€æ¬¡å¯¹è¯ï¼Œè†å¬ä»–çš„æ•™è¯²ã€‚", npc:"village_chief", objectives:[{type:"dialogue",target:"village_chief",amount:1,desc:"ä¸æ‘é•¿å¯¹è¯1æ¬¡"}], rewards:{gold:150}, prereqs:[], order:1 },
        { id:"daily_maid_01", name:"å¥³ä»†çš„å¿ƒæ„", desc:"å‘ä»»æ„NPCèµ é€2ä»½ç¤¼ç‰©ã€‚", npc:"maid", objectives:[{type:"gift_give",target:"any",amount:2,desc:"å‘ä»»æ„NPCèµ é€2ä»½ç¤¼ç‰©"}], rewards:{gold:200}, prereqs:[], order:1 },
        { id:"daily_scholar_01", name:"æ—¥å¸¸ç ”ç©¶", desc:"è®¿é—®3ä¸ªä¸åŒçš„åœºæ™¯ï¼Œæ”¶é›†ç ”ç©¶ç´ æã€‚", npc:"scholar_xiaomei", objectives:[{type:"scene_visit",target:"any",amount:3,desc:"è®¿é—®3ä¸ªä¸åŒåœºæ™¯"}], rewards:{gold:200}, prereqs:[], order:1 },
        { id:"daily_summoner_01", name:"å¼‚ç•Œæ„Ÿåº”", desc:"æ‹›å‹Ÿä¸€åå†’é™©è€…ï¼Œæ„Ÿå—å¼‚ç•Œçš„åŠ›é‡ã€‚", npc:"summoner_kaoezi", objectives:[{type:"recruit",target:"any",amount:1,desc:"æ‹›å‹Ÿ1åå†’é™©è€…"}], rewards:{gold:150}, prereqs:[], order:1 }
      ]
    };

    function renderRewards(r) {
      let html = '';
      if (r.gold) html += `<span class="reward-tag reward-gold">ğŸ’° ${r.gold} é‡‘å¸</span>`;
      if (r.crystal) html += `<span class="reward-tag reward-crystal">ğŸ’ ${r.crystal} æ°´æ™¶</span>`;
      if (r.unlockNpc) html += `<span class="reward-tag reward-unlock">ğŸ”“ è§£é” ${NPC_NAMES[r.unlockNpc] || r.unlockNpc}</span>`;
      if (r.unlockStage) html += `<span class="reward-tag reward-unlock">ğŸ—ºï¸ è§£é” ${r.unlockStage}</span>`;
      if (r.items) r.items.forEach(i => { html += `<span class="reward-tag reward-item">ğŸ“¦ ${i.id} x${i.qty}</span>`; });
      return html;
    }

    function renderCard(q, type) {
      const badgeClass = `badge-${type}`;
      const orderClass = `order-${type}`;
      const npcName = NPC_NAMES[q.npc] || q.npc;

      let objsHtml = q.objectives.map(o => `
        <div class="objective">
          <span class="obj-icon">${OBJ_ICONS[o.type] || 'ğŸ“‹'}</span>
          <span>${o.desc}</span>
          <span class="obj-amount">x${o.amount}</span>
        </div>
      `).join('');

      let prereqHtml = '';
      if (q.prereqs.length > 0) {
        const names = q.prereqs.map(pid => {
          for (const t of ['main','side','daily']) {
            const found = quests[t].find(x => x.id === pid);
            if (found) return found.name;
          }
          return pid;
        });
        prereqHtml = `<div class="prereq">å‰ç½®ä»»åŠ¡: <span>${names.join(', ')}</span></div>`;
      }

      return `
        <div class="quest-card">
          <div class="quest-header">
            <div class="quest-order ${orderClass}">${q.order}</div>
            <div class="quest-name">${q.name}</div>
            <span class="quest-type-badge ${badgeClass}">${TYPE_NAMES[type]}</span>
          </div>
          <div class="quest-desc">${q.desc}</div>
          <div class="quest-meta">
            <span class="meta-tag">ğŸ“ ${npcName}</span>
            <span class="meta-tag">ğŸ†” ${q.id}</span>
          </div>
          <div class="objectives-title">ğŸ“‹ ä»»åŠ¡ç›®æ ‡</div>
          ${objsHtml}
          <div class="rewards">
            <div class="rewards-title">ğŸ å¥–åŠ±</div>
            <div class="reward-list">${renderRewards(q.rewards)}</div>
          </div>
          ${prereqHtml}
        </div>
      `;
    }

    function renderSection(type, title) {
      const list = quests[type];
      if (!list || list.length === 0) return '';

      if (type === 'main') {
        // Render as flow chart
        let html = `<div class="section section-${type}"><div class="section-title">${title} (${list.length})</div><div class="flow-container">`;
        list.forEach((q, i) => {
          html += `<div class="flow-card">${renderCard(q, type)}</div>`;
          if (i < list.length - 1) html += `<div class="flow-arrow">â¬‡</div>`;
        });
        html += '</div></div>';
        return html;
      }

      let html = `<div class="section section-${type}"><div class="section-title">${title} (${list.length})</div><div class="quest-grid">`;
      list.forEach(q => { html += renderCard(q, type); });
      html += '</div></div>';
      return html;
    }

    let currentTab = 'all';

    function showTab(tab) {
      currentTab = tab;
      document.querySelectorAll('.tab-btn').forEach(b => {
        b.className = 'tab-btn';
      });
      event.target.classList.add(`active-${tab}`);
      render();
    }

    function render() {
      const el = document.getElementById('content');
      let html = '';
      if (currentTab === 'all' || currentTab === 'main') html += renderSection('main', 'âš”ï¸ ä¸»çº¿ä»»åŠ¡');
      if (currentTab === 'all' || currentTab === 'side') html += renderSection('side', 'ğŸ“œ æ”¯çº¿ä»»åŠ¡');
      if (currentTab === 'all' || currentTab === 'daily') html += renderSection('daily', 'ğŸ”„ æ—¥å¸¸ä»»åŠ¡');
      el.innerHTML = html;
    }

    render();
  </script>
</body>
</html>
